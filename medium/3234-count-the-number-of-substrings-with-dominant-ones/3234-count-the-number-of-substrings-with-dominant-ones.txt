                for (int l = Lmin; l <= Lmax; l++) {
                    if (pref[Rmax + 1] - pref[l] < need) continue;
                    while (r <= Rmax && pref[r + 1] - pref[l] < need) r++;
                    if (r > Rmax) break;
                    ans += (Rmax - r + 1);
                }
            }
        }
        return (int) ans;  
    }
}